!function(){"use strict";angular.module("ngTournamentBracket",[]).run(["$templateCache",function(a){a.put("ngTournamentBracket/templates/tournamentBracket.html",['<div class="tournament-bracket-container">',"<table>","<thead>","<tr>",'<th ng-repeat="round in teams">',"<span>{{round.header}}</span>","</th>","</tr>","</thead>","<tbody>","<tr>","<td ng-repeat=\"round in teams\" class=\"round round-{{ round.roundOf }}\" ng-class=\"round.side == 'right' ? 'reversed' : 'forward'\">",'<tournament-game games="round.games"></tournament-game>',"</td>","</tr>","</tbody>","</table>","</div>"].join("")),a.put("ngTournamentBracket/templates/tournamentGame.html",['<div class="tournament-round-container">','<div ng-repeat="game in games" class="tournament-game">','<div class="game">','<div ng-repeat="team in game.teams" class="segment" ng-class="$index == 0 ? \'top\' : \'bottom\'">',"<span ng-class=\"isWinner(game.teams, team.id) ? 'winner' : 'loser'\">",'<a href="#">','<img ng-src="{{team.image}}" alt="{{team.name}}" />',"<span>{{team.name}}</span>","</a>","<strong>{{team.score}}</strong>","</span>","</div>","</div>","</div>","</div>"].join(""))}]).factory("tournamentService",["$log",function(a){function b(a,b){for(var c=1;c<=b;c++)a.push({bye:!0})}function c(a){for(var b=[],c=a.length,d=1;d<=c/2;d++)b.push(new e(a[c-d],a[d-1]));return b}function d(a){for(var b=a.length;b>0;){var c=Math.floor(Math.random()*b);b--;var d=a[b];a[b]=a[c],a[c]=d}return a}function e(a,b){return{id:f(),visitor:a,home:b}}function f(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}return{generateGames:function(f,g,h){if(f.length<3)return void a.error("You must have at least 3 teams.");if(f.length>64)return void a.error("You can only create brackets for 64 or fewer teams.");switch(h&&(f=d(f)),g){case"single-elimination":break;case"double-elimination":break;case"round-robin":}var i=Math.ceil(Math.log(f.length)/Math.log(2)),j=Math.pow(2,i);j!=f.length&&b(f,j-f.length);for(var k=c(f),l=[],m=0;m<i;m++){var n;if(0==m){l.push({leftBracket:[],rightBracket:[]});for(var o=0;o<k.length;o++)o%2===0?l[m].leftBracket.push(k[o]):l[m].rightBracket.push(k[o])}else if(m==i-1)l.push({championship:[],bronze:[]}),n=new e(l[m-1].leftBracket[0].id,l[m-1].rightBracket[0].id),l[m].championship.push(n),l[m].bronze.push(n);else{l.push({leftBracket:[],rightBracket:[]});for(var p=0;p<l[m-1].leftBracket.length/2;p+=2)n=new e(l[m-1].leftBracket[p].id,l[m-1].leftBracket[p+1].id),l[m].leftBracket.push(n);for(var q=0;q<l[m-1].rightBracket.length/2;q++)n=new e(l[m-1].rightBracket[q].id,l[m-1].rightBracket[q+1].id),l[m].rightBracket.push(n)}}return a.info(f),a.info(l),a.info(JSON.stringify(l)),l}}}]).directive("tournamentBracket",["tournamentService",function(a){return{restrict:"E",replace:!0,scope:{teams:"=",type:"@",shuffleTeams:"@"},templateUrl:"ngTournamentBracket/templates/tournamentBracket.html",controller:function(a){a.type=angular.isDefined(a.type)?a.type:"single-elimination",a.shuffleTeams=!!angular.isDefined(a.shuffleTeams)&&"true"===a.shuffleTeams.toLowerCase()},link:function(a,b,c){a.columns=[{title:"Final"}]}}}]).directive("tournamentGame",["tournamentService",function(a){return{restrict:"E",replace:!0,scope:{games:"="},templateUrl:"ngTournamentBracket/templates/tournamentGame.html",controller:function(a){a.isWinner=function(a,b){var c=a[0].id==b?0:1;return c?a[1].score>a[0].score:a[0].score>a[1].score}},link:function(a,b,c){}}}])}();